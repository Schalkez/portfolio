---
import About from "$components/About/About.astro";
import BlogLatest from "$components/Blog/BlogLatest.astro";
import Contact from "$components/Contact/Contact.astro";
import Footer from "$components/Footer.astro";
import PlanetScene from "$components/Hero/3D/PlanetScene.svelte";
import Hero from "$components/Hero/Hero.svelte";
import Learning from "$components/Learning/Learning.svelte";
import Navbar from "$components/Navigation/Navbar.svelte";
import Projects from "$components/Projects/Projects.astro";
import ProjectsPlaceholder from "$components/Projects/ProjectsPlaceholder.astro";
import BaseLayout from "$layouts/BaseLayout.astro";
import { getLocale } from "astro-i18n-aut";
import { getFeaturedProjects } from "src/utils";
import { SHOW_PROJECTS, SITE, SITE_NAME } from "src/config";

const lang = getLocale(Astro.url);
const _projects = await getFeaturedProjects(lang);

// SEO meta tags cho trang chủ
const seoProps = {
  title: `${SITE_NAME} by Hiền Nguyen`,
  description:
    "Modern dev playbook from Hiền Nguyen — full-stack workflows, AI-assisted delivery, and projects built with Astro, Svelte, React, and TypeScript.",
  keywords:
    "hiền, software engineer, full-stack developer, portfolio, web development, astro, svelte, react, typescript, javascript",
  type: "website",
};

// Structured data cho trang chủ
const homeStructuredData = {
  "@context": "https://schema.org",
  "@type": "WebPage",
  name: SITE_NAME,
  description:
    "Modern Dev Playbook by Hiền Nguyen: strategies, experiments, and projects for shipping fast and clean.",
  url: SITE,
  mainEntity: {
    "@type": "Person",
    name: "Hiền",
    jobTitle: "Full-Stack Software Engineer",
    description: "Passionate full-stack software engineer",
    knowsAbout: [
      "Web Development",
      "Astro",
      "Svelte",
      "React",
      "TypeScript",
      "JavaScript",
    ],
  },
};
---

<BaseLayout {...seoProps}>
  <script type="application/ld+json" set:html={JSON.stringify(homeStructuredData)} />

  <Navbar client:load lang={lang} />
  <PlanetScene client:visible />
  <Hero client:load lang={lang} />
  <About lang={lang} />
  {SHOW_PROJECTS ? (
    <Projects projects={_projects} lang={lang} />
  ) : (
    <ProjectsPlaceholder lang={lang} />
  )}
  <BlogLatest lang={lang} />
  <Learning client:visible lang={lang} />
  <Contact lang={lang} />
  <Footer lang={lang} />
</BaseLayout>
